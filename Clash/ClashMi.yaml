 # ClashMi
 # author : William
 # ==================== 用戶配置區
 
allow-lan: true
unified-delay: true
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome

profile:
    store-selected: true
    store-fake-ip: true

sniffer:
    enable: true
    sniff:
        HTTP:
            ports: [80, 8080-8880]
            override-destination: true
        TLS:
            ports: [443, 8443]
        QUIC:
            ports: [443, 8443]
    skip-domain:
        - "Mijia Cloud"
        - dlg.io.mi.com
        - "+.push.apple.com"
        
tun:
    enable: true
    stack: system
    device: mihomo
    dns-hijack:
       - any:53
       - tcp://any:53
    auto-route: true
    auto-detect-interface: true
    strict-route: true
    endpoint-independent-nat: true
    
dns:
  enable: true
  ipv6: false
  respect-rules: true
  default-nameserver:
     - 223.5.5.5
     - 223.6.6.6
  nameserver:
     - 223,5,5,5
     - 223.6.6.6
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
      - '*.lan'
      - '*.localdomain'
      - '*.example'
      - '*.invalid'
      - '*.localhost'
      - '*.test'
      - '*.local'
      - '*.home.arpa'
      - '*.direct'
      - 'time.*.com'
      - 'time.*.gov'
      - 'time.*.edu.cn'
      - 'time.*.apple.com'
      - 'time-ios.apple.com'
      - 'time1.*.com'
      - 'time2.*.com'
      - 'time3.*.com'
      - 'time4.*.com'
      - 'time5.*.com'
      - 'time6.*.com'
      - 'time7.*.com'
      - 'ntp.*.com'
      - 'ntp1.*.com'
      - 'ntp2.*.com'
      - 'ntp3.*.com'
      - 'ntp4.*.com'
      - 'ntp5.*.com'
      - 'ntp6.*.com'
      - 'ntp7.*.com'
      - '*.time.edu.cn'
      - '*.ntp.org.cn'
      - '+.pool.ntp.org'
      - 'time1.cloud.tencent.com'
      - 'music.163.com'
      - '*.music.163.com'
      - '*.126.net'
      - 'musicapi.taihe.com'
      - 'music.taihe.com'
      - 'songsearch.kugou.com'
      - 'trackercdn.kugou.com'
      - '*.kuwo.cn'
      - 'api-jooxtt.sanook.com'
      - 'api.joox.com'
      - 'joox.com'
      - 'y.qq.com'
      - '*.y.qq.com'
      - 'streamoc.music.tc.qq.com'
      - 'mobileoc.music.tc.qq.com'
      - 'isure.stream.qqmusic.qq.com'
      - 'dl.stream.qqmusic.qq.com'
      - 'aqqmusic.tc.qq.com'
      - 'amobile.music.tc.qq.com'
      - '*.xiami.com'
      - '*.music.migu.cn'
      - 'music.migu.cn'
      - '+.msftconnecttest.com'
      - '+.msftncsi.com'
      - 'localhost.ptlogin2.qq.com'
      - 'localhost.sec.qq.com'
      - 'localhost.*.weixin.qq.com'
      - '+.steamcontent.com'
      - '+.srv.nintendo.net'
      - '*.n.n.srv.nintendo.net'
      - '+.cdn.nintendo.net'
      - '+.stun.playstation.net'
      - 'xbox.*.*.microsoft.com'
      - '*.*.xboxlive.com'
      - 'xbox.*.microsoft.com'
      - 'xnotify.xboxlive.com'
      - '+.battle.net'
      - '+.battlenet.com.cn'
      - '+.wotgame.cn'
      - '+.wggames.cn'
      - '+.wowsgame.cn'
      - '+.wargaming.net'
      - 'proxy.golang.org'
      - 'stun.*.*'
      - 'stun.*.*.*'
      - '+.stun.*.*'
      - '+.stun.*.*.*'
      - '+.stun.*.*.*.*'
      - '+.stun.*.*.*.*.*'
      - 'heartbeat.belkin.com'
      - '*.linksys.com'
      - '*.linksyssmartwifi.com'
      - '*.router.asus.com'
      - 'mesu.apple.com'
      - 'swscan.apple.com'
      - 'swquery.apple.com'
      - 'swdownload.apple.com'
      - 'swcdn.apple.com'
      - 'swdist.apple.com'
      - 'lens.l.google.com'
      - 'stun.l.google.com'
      - 'na.b.g-tun.com'
      - '+.nflxvideo.net'
      - '*.square-enix.com'
      - '*.finalfantasyxiv.com'
      - '*.ffxiv.com'
      - '*.ff14.sdo.com'
      - 'ff.dorado.sdo.com'
      - '*.mcdn.bilivideo.cn'
      - '+.media.dssott.com'
      - 'shark007.net'
      - 'Mijia Cloud'
      - '+.market.xiaomi.com'
      - '+.cmbchina.com'
      - '+.cmbimg.com'
      - 'adguardteam.github.io'
      - 'adrules.top'
      - 'anti-ad.net'
      - 'local.adguard.org'
      - 'static.adtidy.org'
      - '+.sandai.net'
      - '+.n0808.com'
      - '+.3gppnetwork.org'
      - '+.uu.163.com'
      - 'ps.res.netease.com'
      - '+.oray.com'
      - '+.orayimg.com'
      - '+.gcloudcs.com'
      - '+.gcloudsdk.com'
      
proxy-groups:

  - name: Proxy
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Quantumult_X.png
    type: select
    proxies:
       - US
       - JP
       - NL
       - Download
       - HK
       - SG
       - TW
       - All
       - DIRECT
    url: 'http://www.google.com/generate_204'

  - name: Google
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Google.png
    type: select
    proxies:
       - Proxy
       - DIRECT
    url: 'http://www.google.com/generate_204'
 
  - name: TG
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Telegram.png
    type: select
    proxies:
       - Proxy
       - US
       - JP
       - NL
       - Download
       - HK
       - SG
       - TW
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'

  - name: X
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Twitter.png
    type: select
    proxies:
       - Proxy
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'
 
  - name: YouTube
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/YouTube.png
    type: select
    proxies:
       - Proxy
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'
  
  - name: Github
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/github.png
    type: select
    proxies:
       - Proxy
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'

  - name: OpenAI
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Bot.png
    type: select
    proxies:
       - Proxy
       - All
    url: 'http://cp.cloudflare.com/generate_204'
  
  - name: Microsoft
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Microsoft.png
    type: select
    proxies:
       - Proxy
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'

  - name: Bilibili
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/bilibili.png
    type: select
    proxies:
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'
 
  - name: Game
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Game.png
    type: select
    proxies:
       - Proxy
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'

  - name: World
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_Nations.png
    type: select
    proxies:
       - Proxy
       - US
       - JP
       - NL
       - Download
       - HK
       - SG
       - TW
       - All
       - DIRECT
    url: 'http://cp.cloudflare.com/generate_204'


  #分隔,下面是地區分組

  - name: US
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_States.png
    include-all: true
    filter: "(?i)美|us|unitedstates|united states|c7s1|c7s2|c7s3"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    #hidden: true
    
  - name: JP
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Japan.png
    include-all: true
    filter: "(?i)日|jp|japan|c7s4"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    #hidden: true

  - name: SG
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Singapore.png
    include-all: true
    filter: "(?i)新|sg|singapore"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    hidden: true

  - name: NL
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Germany.png
    include-all: true
    filter: "(?i)nl|荷|c7s5"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    #hidden: true
    
  - name: HK
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hong_Kong.png
    include-all: true
    filter: "(?i)港|hk|hongkong|hong kong"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    hidden: true
          
  - name: TW
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Taiwan.png
    include-all: true
    filter: "(?i)台|tw|taiwan"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    hidden: true

  - name: Download
    type: select
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Qure.png
    include-all: true
    filter: "(?i)(c7s801)"
    url: 'http://www.apple.com/library/test/success.html'
    interval: 300
    strategy: consistent-hashing
    #hidden: true

  - name: Ads
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hijacking.png
    type: select
    proxies:
       - REJECT
    hidden: true

  - name: All
    icon: https://testingcf.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Global.png
    type: select
    include-all: true

rule-providers:

  LocalAreaNetwork:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/LocalAreaNetwork.list
    path: ./ruleset/LocalAreaNetwork.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  UnBan:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/UnBan.list
    path: ./ruleset/UnBan.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  BanAD:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanAD.list
    path: ./ruleset/BanAD.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  BanProgramAD:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanProgramAD.list
    path: ./ruleset/BanProgramAD.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  SteamCN:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/SteamCN.list
    path: ./ruleset/SteamCN.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  Bing:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Bing.list
    path: ./ruleset/Bing.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  OneDrive:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/OneDrive.list
    path: ./ruleset/OneDrive.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  MicrosoftRule:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Microsoft.list
    path: ./ruleset/Microsoft.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  Telegram:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Telegram.list
    path: ./ruleset/Telegram.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  Epic:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Epic.list
    path: ./ruleset/Epic.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  Steam:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Steam.list
    path: ./ruleset/Steam.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  YoutubeRule:
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    path: ./ruleset/Youtube.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  
  GoogleRule:
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    path: ./ruleset/Google.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
    
  Twitter:
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.yaml
    path: ./ruleset/Twitter.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
  
  BilibiliHMT:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/BilibiliHMT.list
    path: ./ruleset/BilibiliHMT.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  BilibiliRule:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Bilibili.list
    path: ./ruleset/Bilibili.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  ChinaMedia:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaMedia.list
    path: ./ruleset/ChinaMedia.list
    behavior: classical
    interval: 86400
    format: text
    type: http
    
  ProxyGFWlist:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ProxyGFWlist.list
    path: ./ruleset/ProxyGFWlist.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  Wechat:
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/WeChat/WeChat.yaml
    path: ./ruleset/WeChat.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http
    
  ChinaDomain:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaDomain.list
    path: ./ruleset/ChinaDomain.list
    behavior: domain
    interval: 86400
    format: text
    type: http
    
  ChinaCompanyIp:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaCompanyIp.list
    path: ./ruleset/ChinaCompanyIp.list
    behavior: ipcidr
    interval: 86400
    format: text
    type: http

  collection: 
    url: "https://gist.githubusercontent.com/cnfree8964/0864fd1d2e88936a095fb40d74ce4993/raw/collection.yaml"
    path: ./rules/collection.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http

rules:
  - "RULE-SET,LocalAreaNetwork,DIRECT"
  - "RULE-SET,UnBan,DIRECT"
  - "RULE-SET,BanAD,Ads"
  - "RULE-SET,BanProgramAD,Ads"
  - "RULE-SET,SteamCN,DIRECT"
  - "RULE-SET,Bing,Microsoft"
  - "RULE-SET,OneDrive,Microsoft"
  - "RULE-SET,MicrosoftRule,Microsoft"
  - "RULE-SET,Telegram,TG,no-resolve"
  - "RULE-SET,Epic,Game"
  - "RULE-SET,Steam,Game"
  - "RULE-SET,Twitter,X"
  - "RULE-SET,YoutubeRule,YouTube"
  - "RULE-SET,GoogleRule,Google,no-resolve"
  - "RULE-SET,BilibiliHMT,Bilibili"
  - "RULE-SET,BilibiliRule,Bilibili"
  - "RULE-SET,Wechat,DIRECT"
  - "RULE-SET,ChinaMedia,DIRECT"
  - "RULE-SET,ProxyGFWlist,Proxy"
  - "RULE-SET,ChinaDomain,DIRECT"
  - "RULE-SET,ChinaCompanyIp,DIRECT"
  - "RULE-SET,collection,DIRECT"
  - "MATCH,World"
